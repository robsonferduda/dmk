$(document).ready(function(){var path="autocompleteCliente";var pathCorrespondente="autocompleteCorrespondente";$("#correspondente_auto_complete").autocomplete({source:pathCorrespondente,minLength:3,select:function(event,ui){$("input[name='cd_correspondente_cor']").val(ui.item.id);$("#taxa-honorario-correspondente").val('');},open:function(event,ui){}});$("#correspondente_auto_complete").focusout(function(){if($("input[name='cd_correspondente_cor']").val()==''){$("#correspondente_auto_complete").val('');}});$("#client").focusout(function(){if($("input[name='cd_cliente_cli']").val()==''){$("#client").val('');}});$("#client").autocomplete({source:path,minLength:2,select:function(event,ui){$("input[name='cd_cliente_cli']").val(ui.item.id);$("input[name='nota_fiscal_cliente']").val(ui.item.nota);$("input[name='nota_fiscal_cliente']").prop('disabled',false);$("#taxa-honorario-cliente").val('');buscaAdvogado();},open:function(event,ui){}});$('#tipoServico').change(function(){$("#taxa-honorario-cliente").val('');$("#taxa-honorario-correspondente").val('');var cliente=$("input[name='cd_cliente_cli']").val();var cidade=$("select[name='cd_cidade_cde']").val();var tipoServico=$(this).val();if(cliente!=''&&cidade!=''&&tipoServico!=''){$.ajax({url:'../busca-valor-cliente/'+cliente+'/'+cidade+'/'+tipoServico,type:'GET',dataType:'JSON',beforeSend:function(){},success:function(response){if(response){var response=JSON.parse(response);$("#taxa-honorario-cliente").val(response.nu_taxa_the);}},error:function(response){}});}
var correspondente=$("input[name='cd_correspondente_cor']").val();if(correspondente!=''&&cidade!=''&&tipoServico!=''){$.ajax({url:'../busca-valor-correspondente/'+correspondente+'/'+cidade+'/'+tipoServico,type:'GET',dataType:'JSON',beforeSend:function(){},success:function(response){if(response){var response=JSON.parse(response);$("#taxa-honorario-correspondente").val(response.nu_taxa_the);}},error:function(response){}});}});var buscaAdvogado=function(){var cliente=$("input[name='cd_cliente_cli']").val();$.ajax({url:'../advogados-por-cliente/'+cliente,type:'GET',dataType:"JSON",beforeSend:function(){},success:function(response){$('#cd_contato_cot').empty();$('#cd_contato_cot').append('<option selected value="">Selecione um Advogado Solicitante</option>');$.each(response,function(index,element){if($("#contatoAux").val()!=element.cd_contato_cot){$('#cd_contato_cot').append('<option value="'+element.cd_contato_cot+'">'+element.nm_contato_cot+'</option>');}else{$('#cd_contato_cot').append('<option selected value="'+element.cd_contato_cot+'">'+element.nm_contato_cot+'</option>');}});},error:function(response){}});}
var buscaCidade=function(){estado=$("#estado").val();if(estado!=''){$.ajax({url:'../cidades-por-estado/'+estado,type:'GET',dataType:"JSON",beforeSend:function(){$('#cidade').empty();$('#cidade').append('<option selected value="">Carregando...</option>');$('#cidade').prop("disabled",true);},success:function(response){$('#cidade').empty();$('#cidade').append('<option selected value="">Selecione</option>');$.each(response,function(index,element){if($("#cd_cidade_cde_aux").val()!=element.cd_cidade_cde){$('#cidade').append('<option value="'+element.cd_cidade_cde+'">'+element.nm_cidade_cde+'</option>');}else{$('#cidade').append('<option selected value="'+element.cd_cidade_cde+'">'+element.nm_cidade_cde+'</option>');}});$('#cidade').trigger('change');$('#cidade').prop("disabled",false);},error:function(response){}});}}
if($("input[name='cd_cliente_cli']").val()!=''&&$("input[name='cd_cliente_cli']").val()!=null){buscaAdvogado();$("input[name='nota_fiscal_cliente']").prop('disabled',false);}
buscaCidade();$("#estado").change(function(){buscaCidade();});$(function(){var validobj=$("#frm-add-processo").validate({ignore:'input[type=hidden], .select2-input, .select2-focusser',rules:{nm_cliente_cli:{required:true,},nu_processo_pro:{required:true},cd_tipo_processo_tpo:{required:true},cd_cidade_cde:{required:true},cd_tipo_servico_tse:{required:true}},messages:{nm_cliente_cli:{required:'Campo Cliente é Obrigatório'},nu_processo_pro:{required:'Campo Nº Processo é Obrigatório'},cd_tipo_processo_tpo:{required:'Campo Tipo de Processo é Obrigatório'},cd_cidade_cde:{required:'Campo Cidade é Obrigatório'},cd_tipo_servico_tse:{required:'Campo Tipo de Serviço é Obrigatório'}},errorPlacement:function(error,element){var elem=$(element);console.log(elem);if(element.attr("name")=="cd_cidade_cde"||element.attr("name")=="cd_tipo_servico_tse"){error.appendTo(element.next("span"));}else{error.insertAfter(element);}},highlight:function(element,errorClass,validClass){var elem=$(element);if(elem.hasClass("select2-offscreen")){$("#s2id_"+elem.attr("id")+" ul").addClass(errorClass);}else{elem.addClass(errorClass);}},unhighlight:function(element,errorClass,validClass){var elem=$(element);if(elem.hasClass("select2-offscreen")){$("#s2id_"+elem.attr("id")+" ul").removeClass(errorClass);}else{elem.removeClass(errorClass);}}});$(document).on("change",".select2",function(){if(!$.isEmptyObject(validobj.submitted)){validobj.form();}});});$('#cidade').select2({}).focus(function(){$(this).select2('focus');});});