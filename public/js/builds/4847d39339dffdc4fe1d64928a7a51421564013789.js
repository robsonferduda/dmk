$(document).ready(function(){var _location=document.location.toString();var applicationNameIndex=_location.indexOf('/',_location.indexOf('://')+3);var applicationName=_location.substring(0,applicationNameIndex)+'/';var webFolderIndex=_location.indexOf('/',_location.indexOf(applicationName)+applicationName.length);var pathname=_location.substring(0,webFolderIndex);var pathnameX=_location.substring(0,webFolderIndex);$('.hr_audiencia_pro').mask('00:00');$('.dt_prazo_fatal_pro').mask('00/00/0000');$('.dt_solicitacao_pro').mask('00/00/0000');$('.data_nascimento').mask('00/00/0000');$('.data_fundacao').mask('00/00/0000');$('.data_admissao').mask('00/00/0000');$('.cep').mask('00000-000');$('.cpf').mask('000.000.000-00');$('.cnpj').mask("00.000.000/0000-00");$('.telefone').mask("(00) 00000-0009");$(".taxa-honorario").mask('#####000,00',{reverse:true});$(".taxa-despesa").mask('#####000,00',{reverse:true});$("#taxa_imposto_cli").mask('#####000,00',{reverse:true});var CpfCnpjMaskBehavior=function(val){return val.replace(/\D/g,'').length<=11?'000.000.000-009':'00.000.000/0000-00';},cpfCnpjpOptions={onKeyPress:function(val,e,field,options){field.mask(CpfCnpjMaskBehavior.apply({},arguments),options);}};$(function(){$('#nu_cpf_cnpj_dba').mask(CpfCnpjMaskBehavior,cpfCnpjpOptions);})
if($('aside').height()<800){$("#main").css('min-height',($('aside').height()+200));$("aside").css('height',($('#main').height()));}
$(".item_pai").click(function(){if($('aside').height()<800){$("#main").css('min-height',($('aside').height()+200));$("aside").css('height',($('#main').height()));}});if($('#observacao').length){CKEDITOR.editorConfig=function(config){config.toolbar='MyToolbar';config.toolbar_MyToolbar=[{name:'document',items:['NewPage','Preview']},];};CKEDITOR.replace('observacao',{toolbar:[{name:'document',items:['NewPage','Preview']},{name:'clipboard',items:['Cut','Copy','Paste','PasteText','-','Undo','Redo']},{name:'insert',items:['Image','Table','HorizontalRule','Smiley','SpecialChar','PageBreak']},'/',{name:'styles',items:['Styles','Format']},{name:'basicstyles',items:['Bold','Italic','Strike','-','RemoveFormat']},{name:'paragraph',items:['NumberedList','BulletedList','-','Outdent','Indent','-','Blockquote']},{name:'links',items:['Link','Unlink','Anchor']}],height:'200px',startupFocus:true});}
$('.upload-result').on('click',function(ev){$uploadCrop.croppie('result',{type:'canvas',size:'viewport'}).then(function(resp){$.ajax({url:pathname+"/image-crop",type:"POST",data:{"image":resp},success:function(data){html='<img src="'+resp+'" />';$("#upload-demo-i").html(html);}});});location.reload();});if($('input:radio[name=cd_tipo_pessoa_tpp]:checked').val()==1){$(".label-tipo-pessoa").html('Nome');$("#cpf").focus();$(".box-pessoa-fisica").css('display','block');$(".box-pessoa-juridica").css('display','none');}else{$(".label-tipo-pessoa").html('Nome Fantasia');$(".box-pessoa-fisica").css('display','none');$(".box-pessoa-juridica").css('display','block');$("#cnpj").focus();}
$(".tipo-pessoa").click(function(){if($('input:radio[name=cd_tipo_pessoa_tpp]:checked').val()==1){$(".label-tipo-pessoa").html('Nome');$(".box-pessoa-fisica").css('display','block');$(".box-pessoa-juridica").css('display','none');$("#cpf").focus();}else{$(".label-tipo-pessoa").html('Nome Fantasia');$(".box-pessoa-fisica").css('display','none');$(".box-pessoa-juridica").css('display','block');$("#cnpj").focus();}});$(".roleOption").click(function(){var id=$(this).data('id');$("#role_msg h3").remove();$("#user").val(id);$("#table-user-role > tbody > tr").remove();$.ajax({url:pathname+"/role/usuario/"+id,type:'GET',dataType:"JSON",beforeSend:function(){$("#role_msg_sistema").html('<h3 class="center"><i class="fa fa-cog fa-spin"></i> Buscando dados...</h3>');},success:function(response){if(response.length>0){$.each(response,function(index,value){$('#table-user-role > tbody').append('<tr><td>'+value.name+'</td><td class="center"><a class="excluirUserRole" data-id="'+value.id+'" data-user="'+id+'"><i class="fa fa-trash"></i> Excluir</a></td></tr>');});$(".excluirUserRole").on("click",function(){var user=$(this).data('user');var role=$(this).data('id');deleteUserRole(user,role);});}else{$("#role_msg").html('<h3 class="center">Usuário não possui perfis associados</h3>');}
$("#role_msg_sistema h3").remove();},error:function(response){}});$("#modal_roles").modal('show');});$('#modal_roles').on('show.bs.modal',function(e){$(".msg-selecao-role").html("");});$("#btnAddRole").click(function(){var id=$("#user").val();var role=$("#role option:selected").val();$(".msg-selecao-role").html("");$("#role_msg").html("");if(role>0){$.ajax({type:"POST",url:pathname+"/role/usuario/adicionar",data:{"_token":$('meta[name="token"]').attr('content'),"id":id,"role":role},beforeSend:function(){$("#role_msg").html('<h3 class="center"><i class="fa fa-cog fa-spin"></i> Processando requisição...</h3>');},success:function(response){if(response.status){$("#role_msg").html('<h3 class="center text-success">'+response.msg+'</h3>');$.ajax({url:pathname+"/role/usuario/"+id,type:'GET',dataType:"JSON",beforeSend:function(){$("#role_msg_sistema").html('<h3 class="center"><i class="fa fa-cog fa-spin"></i> Atualizando tabela...</h3>');},success:function(response){if(response.length>0){$("#table-user-role > tbody > tr").remove();$.each(response,function(index,value){$('#table-user-role > tbody').append('<tr><td>'+value.name+'</td><td class="center"><a class="excluirUserRole" data-id="'+value.id+'" data-user="'+id+'"><i class="fa fa-trash"></i> Excluir</a></td></tr>');});$(".excluirUserRole").on("click",function(){var user=$(this).data('user');var role=$(this).data('id');deleteUserRole(user,role);});}else{$("#role_msg").html('<h3 class="center">Usuário não possui perfis associados</h3>');}
$("#role_msg h3").remove();$("#role_msg_sistema h3").remove();},error:function(response){}});}else{$("#role_msg").html('<h3 class="center text-danger">'+response.msg+'</h3>');}},error:function(response){}});}else{$(".msg-selecao-role").html('<span class="text-danger">Selecione um perfil para adicionar</span>');}});function deleteUserRole(user,role){$.ajax({url:pathname+"/role/"+role+"/usuario/delete/"+user,type:'GET',dataType:"JSON",beforeSend:function(){$("#role_msg_sistema").html('<h3 class="center"><i class="fa fa-cog fa-spin"></i> Excluindo perfil...</h3>');},success:function(response){$.ajax({url:pathname+"/role/usuario/"+user,type:'GET',dataType:"JSON",beforeSend:function(){$("#role_msg_sistema").html('<h3 class="center"><i class="fa fa-cog fa-spin"></i> Atualizando perfis...</h3>');},success:function(response){$("#table-user-role > tbody > tr").remove();if(response.length>0){$.each(response,function(index,value){$('#table-user-role > tbody').append('<tr><td>'+value.name+'</td><td class="center"><a class="excluirUserRole" data-id="'+value.id+'" data-user="'+user+'"><i class="fa fa-trash"></i> Excluir</a></td></tr>');});$(".excluirUserRole").on("click",function(){var user=$(this).data('user');var role=$(this).data('id');deleteUserRole(user,role);});}else{$("#role_msg").html('<h3 class="center">Usuário não possui perfis associados</h3>');}
$("#role_msg_sistema h3").remove();},error:function(response){}});},error:function(response){}});}
$(".btn-save-area").click(function(){$(".msg_retorno").html('<h3><i class="fa fa-spinner fa-spin"></i> Processando operação...</h3>');});$(".btn-edit-area").click(function(){$(".msg_retorno").html('<h3><i class="fa fa-spinner fa-spin"></i> Processando operação...</h3>');});$(".excluir_registro").click(function(){var id=$(this).closest('tr').find('td[data-id]').data('id');var url=$(this).data('url');if(!id){id=$(this).data('id');}
$("#modal_exclusao #url").val(url);$("#modal_exclusao #id_exclusao").val(id);$("#modal_exclusao").modal('show');});$(".excluir_registro_honorario").click(function(){var id=$(this).data('id');var url=$(this).data('url');var texto=$(this).data('texto');$("#modal_exclusao_honorario #txt_exclusao_honorario").html(texto);$("#modal_exclusao_honorario #url_honorario").val(url);$("#modal_exclusao_honorario #id_exclusao_honorario").val(id);$("#modal_exclusao_honorario").modal('show');});$(".adicionar_registro").click(function(){var id=$(this).data('id');var url=$(this).data('url');$("#modal_confirma_correspondente #url").val(url);$("#modal_confirma_correspondente #id_correspondente").val(id);$("#modal_confirma_correspondente").modal('show');});$(".remover_registro").click(function(){var id=$(this).data('id');var url=$(this).data('url');$("#modal_cancela_correspondente #url").val(url);$("#modal_cancela_correspondente #id_correspondente").val(id);$("#modal_cancela_correspondente").modal('show');});$(".editar_area").click(function(){var id=$(this).closest('tr').find('td[data-id]').data('id');var descricao=$(this).closest('tr').find('td[data-descricao]').data('descricao');var action="../areas/"+id;$('#frm-edit-area #id_area').val(id);$('#frm-edit-area #dc_area_direito_ado').val(descricao);$('#frm-edit-area').attr('action',action);$('#editArea').modal('show');});$("#btn_confirma_exclusao_honorario").click(function(){var id=$("#id_exclusao_honorario").val();var url=$("#url_honorario").val();var token=$(this).data("token");$.ajax({url:"../../cliente/honorarios/"+url+id,type:'DELETE',dataType:"JSON",data:{"id":id,"_method":'DELETE',"_token":$('meta[name="token"]').attr('content'),},beforeSend:function(){$(".msg_retorno_honorario").html('<h3><i class="fa fa-spinner fa-spin"></i> Processando operação...</h3>');},success:function(response){$(".msg_retorno_honorario").html('<h4 class="text-success marginTop10"><strong>Registro excluído com sucesso. Os dados serão atualizados!</strong></h4>')
location.reload();},error:function(response){$(".msg_retorno_honorario").html('<h4 class="text-danger marginTop10"><strong>Ocorreu um erro na sua requisição.</strong></h4>')}});});$("#btn_confirma_exclusao").click(function(){var id=$("#id_exclusao").val();var url=$("#url").val();var token=$(this).data("token");$.ajax({url:url+id,type:'DELETE',dataType:"JSON",data:{"id":id,"_method":'DELETE',"_token":$('meta[name="token"]').attr('content'),},beforeSend:function(){$(".msg_retorno").html('<h3><i class="fa fa-spinner fa-spin"></i> Processando operação...</h3>');},success:function(response){$(".msg_retorno").html('<h4 class="text-success marginTop10"><strong>Registro excluído com sucesso. Os dados serão atualizados!</strong></h4>')
location.reload();},error:function(response){$(".msg_retorno").html('<h4 class="text-danger marginTop10"><strong>Ocorreu um erro na sua requisição.</strong></h4>')}});});$(".alterar_senha").click(function(){var id=$(this).closest('tr').find('td[data-id]').data('id');var action="usuarios/alterar-senha/"+id;$('#frm-alterar-senha #id').val(id);$('#frm-alterar-senha').attr('action',action);$('#alterarSenha').modal('show');});$(".btn-alterar-senha").click(function(){if($('#frm-alterar-senha #password').val().trim()!=''&&$('#frm-alterar-senha #password_confirmation').val().trim()!='')
$(".msg_retorno").html('<h3><i class="fa fa-spinner fa-spin"></i> Processando operação...</h3>');});$(".editar_tipo_contato").click(function(){var id=$(this).closest('tr').find('td[data-id]').data('id');var nome=$(this).closest('tr').find('td[data-nome]').data('nome');var action="../tipos-de-contato/"+id;$('#frm-edit-tipo-contato #cd_tipo_contato_tct').val(id);$('#frm-edit-tipo-contato #nm_tipo_contato_tct').val(nome);$('#frm-edit-tipo-contato').attr('action',action);$('#editTipoContato').modal('show');});$(".btn-save-tipo-contato").click(function(){$(".msg_retorno").html('<h3><i class="fa fa-spinner fa-spin"></i> Processando operação...</h3>');});$(".btn-edit-tipo-contato").click(function(){$(".msg_retorno").html('<h3><i class="fa fa-spinner fa-spin"></i> Processando operação...</h3>');});$(".editar_tipo_servico").click(function(){var id=$(this).closest('tr').find('td[data-id]').data('id');var nome=$(this).closest('tr').find('td[data-nome]').data('nome');var action="../tipos-de-servico/"+id;$('#frm-edit-tipo-servico #cd_tipo_servico_tse').val(id);$('#frm-edit-tipo-servico #nm_tipo_servico_tse').val(nome);$('#frm-edit-tipo-servico').attr('action',action);$('#editTipoServico').modal('show');});$(".btn-save-tipo-processo").click(function(){$(".msg_retorno").html('<h3><i class="fa fa-spinner fa-spin"></i> Processando operação...</h3>');});$(".btn-edit-tipo-processo").click(function(){$(".msg_retorno").html('<h3><i class="fa fa-spinner fa-spin"></i> Processando operação...</h3>');});$(".editar_tipo_processo").click(function(){var id=$(this).closest('tr').find('td[data-id]').data('id');var nome=$(this).closest('tr').find('td[data-nome]').data('nome');var action="../tipos-de-processo/"+id;$('#frm-edit-tipo-processo #cd_tipo_processo_tpo').val(id);$('#frm-edit-tipo-processo #nm_tipo_processo_tpo').val(nome);$('#frm-edit-tipo-processo').attr('action',action);$('#editTipoProcesso').modal('show');});$(".btn-save-tipo-servico").click(function(){$(".msg_retorno").html('<h3><i class="fa fa-spinner fa-spin"></i> Processando operação...</h3>');});$(".btn-edit-tipo-servico").click(function(){$(".msg_retorno").html('<h3><i class="fa fa-spinner fa-spin"></i> Processando operação...</h3>');});$(".editar_tipo_despesa").click(function(){var id=$(this).closest('tr').find('td[data-id]').data('id');var nome=$(this).closest('tr').find('td[data-nome]').data('nome');var reembolso=$(this).closest('tr').find('td[data-reembolso]').data('reembolso');var categoria=$(this).closest('tr').find('td[data-categoria]').data('categoria');var action="../tipos-de-despesa/"+id;$('#frm-edit-tipo-despesa #cd_tipo_despesa_tds').val(id);$('#frm-edit-tipo-despesa #nm_tipo_despesa_tds').val(nome);if(reembolso=='S'){$('#frm-edit-tipo-despesa #fl_reembolso_tds').prop("checked",true);}else{$('#frm-edit-tipo-despesa #fl_reembolso_tds').prop("checked",false);}
$('#frm-edit-tipo-despesa #categoriaDespesa').val(categoria).trigger('change');;$('#frm-edit-tipo-despesa').attr('action',action);$('#editTipoDespesa').modal('show');});$(".btn-save-tipo-despesa").click(function(){$(".msg_retorno").html('<h3><i class="fa fa-spinner fa-spin"></i> Processando operação...</h3>');});$(".btn-edit-tipo-despesa").click(function(){$(".msg_retorno").html('<h3><i class="fa fa-spinner fa-spin"></i> Processando operação...</h3>');});$(".editar_vara").click(function(){var id=$(this).closest('tr').find('td[data-id]').data('id');var nome=$(this).closest('tr').find('td[data-nome]').data('nome');var action="../varas/"+id;$('#frm-edit-vara #cd_vara_var').val(id);$('#frm-edit-vara #nm_vara_var').val(nome);$('#frm-edit-vara').attr('action',action);$('#editVara').modal('show');});$(".btn-save-vara").click(function(){$(".msg_retorno").html('<h3><i class="fa fa-spinner fa-spin"></i> Processando operação...</h3>');});$(".btn-edit-vara").click(function(){$(".msg_retorno").html('<h3><i class="fa fa-spinner fa-spin"></i> Processando operação...</h3>');});$(".editar_cargo").click(function(){var id=$(this).closest('tr').find('td[data-id]').data('id');var nome=$(this).closest('tr').find('td[data-nome]').data('nome');var action="../cargos/"+id;$('#frm-edit-cargo #cd_cargo_car').val(id);$('#frm-edit-cargo #nm_cargo_car').val(nome);$('#frm-edit-cargo').attr('action',action);$('#editCargo').modal('show');});$(".btn-save-cargo").click(function(){$(".msg_retorno").html('<h3><i class="fa fa-spinner fa-spin"></i> Processando operação...</h3>');});$(".btn-edit-cargo").click(function(){$(".msg_retorno").html('<h3><i class="fa fa-spinner fa-spin"></i> Processando operação...</h3>');});$(".editar_departamento").click(function(){var id=$(this).closest('tr').find('td[data-id]').data('id');var nome=$(this).closest('tr').find('td[data-nome]').data('nome');var action="../departamentos/"+id;$('#frm-edit-departamento #cd_departamento_dep').val(id);$('#frm-edit-departamento #nm_departamento_dep').val(nome);$('#frm-edit-departamento').attr('action',action);$('#editDepartamento').modal('show');});$(".btn-save-departamento").click(function(){$(".msg_retorno").html('<h3><i class="fa fa-spinner fa-spin"></i> Processando operação...</h3>');});$(".btn-edit-departamento").click(function(){$(".msg_retorno").html('<h3><i class="fa fa-spinner fa-spin"></i> Processando operação...</h3>');});$(".editar_categoria_despesa").click(function(){var id=$(this).closest('tr').find('td[data-id]').data('id');var nome=$(this).closest('tr').find('td[data-nome]').data('nome');var action="../categorias-de-despesas/"+id;$('#frm-edit-categoria-despesa #cd_categoria_despesa_cad').val(id);$('#frm-edit-categoria-despesa #nm_categoria_despesa_cad').val(nome);$('#frm-edit-categoria-despesa').attr('action',action);$('#editCategoriaDespesa').modal('show');});$(".btn-save-categoria-despesa").click(function(){$(".msg_retorno").html('<h3><i class="fa fa-spinner fa-spin"></i> Processando operação...</h3>');});$(".btn-edit-categoria-despesa").click(function(){$(".msg_retorno").html('<h3><i class="fa fa-spinner fa-spin"></i> Processando operação...</h3>');});var telefones=new Array();var emails=new Array();$("#btnSalvarTelefone").click(function(){var flag=true;var tipo=$("#cd_tipo_fone_tfo option:selected").val();var ds_tipo=$("#cd_tipo_fone_tfo option:selected").text();var numero=$("#nu_fone_fon").val();var entidade=$("#entidade").val();if(tipo==0){flag=false;$("#erroFone").html("Campo tipo obrigatório");}
if(numero==''){flag=false;$("#erroFone").html("Número de telefone obrigatório");}
if(flag){var fone={tipo:tipo,numero:numero,descricao:ds_tipo};telefones.push(fone);$("#tabelaFone > tbody > tr").remove();loadTelefones(entidade);$.each(telefones,function(index,value){$('#tabelaFone > tbody').append('<tr><td class="center">'+value.descricao+'</td><td>'+value.numero+'</td><td class="center"><a class="excluirFone" style="cursor:pointer" data-id="'+index+'"><i class="fa fa-trash"></i> Excluir</a></td></tr>');});$('.excluirFone').on('click',function(){var id=$(this).data("id");var entidade=$("#entidade").val()
telefones.splice(id,1);$("#tabelaFone > tbody > tr").remove();loadTelefones(entidade);$.each(telefones,function(index,value){$('#tabelaFone > tbody').append('<tr><td class="center">'+value.descricao+'</td><td>'+value.numero+'</td><td class="center"><a class="excluirFone" style="cursor:pointer" data-id="'+index+'"><i class="fa fa-trash"></i> Excluir</a></td></tr>');});$("#telefones").val(JSON.stringify(telefones));});$("#nu_fone_fon").val("");$("#cd_tipo_fone_tfo").prop('selectedIndex',0);$("#nu_fone_fon").focus();$('#modalFone').modal('hide');$("#telefones").val(JSON.stringify(telefones));}});function loadRegistroBancario(id){$.ajax({url:"../../registro-bancario/id/"+id,type:'GET',dataType:"JSON",success:function(response){var tamanho=response[0].nu_cpf_cnpj_dba.length;if(tamanho<=11){$("#nu_cpf_cnpj_dba").val(response[0].nu_cpf_cnpj_dba).mask("999.999.999-99");}else{$("#nu_cpf_cnpj_dba").val(response[0].nu_cpf_cnpj_dba).mask("99.999.999/9999-99");}
$("#nm_titular_dba").val(response[0].nm_titular_dba);$("#cd_banco_ban").val(response[0].cd_banco_ban).trigger('change');$("#cd_tipo_conta_tcb").val(response[0].cd_tipo_conta_tcb).trigger('change');$("#nu_agencia_dba").val(response[0].nu_agencia_dba);$("#nu_conta_dba").val(response[0].nu_conta_dba);$('#idRegistroBancario').val(response[0].cd_dados_bancarios_dba);},error:function(response){}});}
$(document).on('click','.editarDadosBancarios',function(){var id=$(this).data("codigo");var nm_titular_dba=$(this).closest('tr').find('td[data-nm_titular_dba]').data('nm_titular_dba');var nu_cpf_cnpj_dba=$(this).closest('tr').find('td[data-nu_cpf_cnpj_dba]').data('nu_cpf_cnpj_dba');var cd_banco_ban=$(this).closest('tr').find('td[data-cd_banco_ban]').data('cd_banco_ban');var cd_tipo_conta_tcb=$(this).closest('tr').find('td[data-cd_tipo_conta_tcb]').data('cd_tipo_conta_tcb');var nu_agencia_dba=$(this).closest('tr').find('td[data-nu_agencia_dba]').data('nu_agencia_dba');var nu_conta_dba=$(this).closest('tr').find('td[data-nu_conta_dba]').data('nu_conta_dba');nu_cpf_cnpj_dba=nu_cpf_cnpj_dba.replace(/\./g,'').replace('-','').replace('/','');var tamanho=nu_cpf_cnpj_dba.length;if(tamanho<=11){$("#nu_cpf_cnpj_dba").val(nu_cpf_cnpj_dba).mask("999.999.999-99");}else{$("#nu_cpf_cnpj_dba").val(nu_cpf_cnpj_dba).mask("99.999.999/9999-99");}
$("#nm_titular_dba").val(nm_titular_dba);$("#cd_banco_ban").val(cd_banco_ban).trigger('change');$("#cd_tipo_conta_tcb").val(cd_tipo_conta_tcb).trigger('change');$("#nu_agencia_dba").val(nu_agencia_dba);$("#nu_conta_dba").val(nu_conta_dba);$(this).next().trigger('click');});var registrosBancarios=new Array();$("#btnSalvarContaBancaria").click(function(){var flag=true;var titular=$("#nm_titular_dba").val();var cpf=$("#nu_cpf_cnpj_dba").val();var banco=$("#cd_banco_ban option:selected").val();var bancoText=$("#cd_banco_ban option:selected").text();var tipo=$("#cd_tipo_conta_tcb option:selected").val();var tipoText=$("#cd_tipo_conta_tcb option:selected").text();var agencia=$("#nu_agencia_dba").val();var conta=$("#nu_conta_dba").val();if(titular.trim()==''){flag=false;$("#erroContaBancaria").html("Campo Titular obrigatório");}
if(cpf.trim()==''){flag=false;$("#erroContaBancaria").html("Campo CPF obrigatório");}
if(banco.trim()==''){flag=false;$("#erroContaBancaria").html("Campo Banco obrigatório");}
if(tipo.trim()==''){flag=false;$("#erroContaBancaria").html("Campo Tipo de Conta obrigatório");}
if(agencia.trim()==''){flag=false;$("#erroContaBancaria").html("Campo Agência obrigatório");}
if(conta.trim()==''){flag=false;$("#erroContaBancaria").html("Campo Conta obrigatório");}
if(flag){var registroBancario={titular:titular,cpf:cpf,banco:banco,bancoText:bancoText,tipo:tipo,tipoText:tipoText,agencia:agencia,conta:conta};registrosBancarios.push(registroBancario);$("#tabelaRegistroBancario > tbody > tr").remove();if($('#entidade').val()!=''){loadRegistrosBancarios($('#entidade').val());}
$.each(registrosBancarios,function(index,value){$('#tabelaRegistroBancario > tbody').append("<tr><td data-nm_titular_dba='"+value.titular+"' >"+value.titular+"</td><td data-nu_cpf_cnpj_dba='"+value.cpf+"' >"+value.cpf+"</td><td data-cd_banco_ban='"+value.banco+"' >"+value.bancoText+"</td><td data-cd_tipo_conta_tcb='"+value.tipo+"' >"+value.tipoText+"</td><td data-nu_agencia_dba='"+value.agencia+"' >"+value.agencia+"</td><td data-nu_conta_dba='"+value.conta+"' >"+value.conta+"</td><td class='center'><a class='editarDadosBancarios' style='cursor:pointer' data-id='"+index+"'><i class='fa fa-edit'></i> Editar</a>&nbsp;<a class='excluiRegistroBancario' style='cursor:pointer' data-id='"+index+"'><i class='fa fa-trash'></i> Excluir</a></td></tr>");});$("#nm_titular_dba").val('');$("#nu_cpf_cnpj_dba").val('');$("#cd_banco_ban").val('').trigger('change');$("#cd_tipo_conta_tcb").val('');$("#nu_agencia_dba").val('');$("#nu_conta_dba").val('');$("#registrosBancarios").val(JSON.stringify(registrosBancarios));}
$('#idRegistroBancario').val('');});$(document).on('click','.excluiRegistroBancario',function(){var id=$(this).data("id");registrosBancarios.splice(id,1);$("#tabelaRegistroBancario > tbody > tr").remove();$.each(registrosBancarios,function(index,value){$('#tabelaRegistroBancario > tbody').append('<tr><td>'+value.titular+'</td><td>'+value.cpf+'</td><td>'+value.bancoText+'</td><td>'+value.tipoText+'</td><td>'+value.agencia+'</td><td>'+value.conta+'</td><td class="center"><a class="excluiRegistroBancario" style="cursor:pointer" data-id="'+index+'"><i class="fa fa-trash"></i> Excluir</a></td></tr>');});if($('#entidade').val()!=''){loadRegistrosBancarios($('#entidade').val());}
$("#registrosBancarios").val(JSON.stringify(registrosBancarios));});$("#btnSalvarEmail").click(function(){var flag=true;var tipo=$("#cd_tipo_endereco_eletronico_tee option:selected").val();var ds_tipo=$("#cd_tipo_endereco_eletronico_tee option:selected").text();var email=$("#dc_endereco_eletronico_ede").val();var entidade=$("#entidade").val();if(tipo==0){flag=false;$("#erroEmail").html("Campo tipo obrigatório");}
if(email==''){flag=false;$("#erroEmail").html("Email obrigatório");}
if(flag){var email={tipo:tipo,email:email,descricao:ds_tipo};emails.push(email);$("#tabelaEmail > tbody > tr").remove();loadEmails(entidade);$.each(emails,function(index,value){$('#tabelaEmail > tbody').append('<tr><td class="center">'+value.descricao+'</td><td>'+value.email+'</td><td class="center"><a class="excluirEmail" data-id="'+index+'"><i class="fa fa-trash"></i> Excluir</a></td></tr>');});$('.excluirEmail').on('click',function(){var id=$(this).data("id");var entidade=$("#entidade").val()
emails.splice(id,1);$("#tabelaEmail > tbody > tr").remove();loadEmails(entidade);$.each(emails,function(index,value){$('#tabelaEmail > tbody').append('<tr><td class="center">'+value.descricao+'</td><td>'+value.email+'</td><td class="center"><a class="excluirEmail" data-id="'+index+'"><i class="fa fa-trash"></i> Excluir</a></td></tr>');});$("#emails").val(JSON.stringify(emails));});$("#dc_endereco_eletronico_ede").val("");$("#cd_tipo_endereco_eletronico_tee").prop('selectedIndex',0);$("#dc_endereco_eletronico_ede").focus();$("#emails").val(JSON.stringify(emails));}});function loadEmails(entidade){$.ajax({url:"../../email/entidade/"+entidade,type:'GET',dataType:"JSON",success:function(response){$.each(response,function(index,value){$('#tabelaEmail > tbody').append('<tr><td class="center">'+value.tipo.dc_tipo_endereco_eletronico_tee+'</td><td>'+value.dc_endereco_eletronico_ede+'</td><td class="center"><a class="excluirEmailBase" data-codigo="'+value.cd_endereco_eletronico_ele+'"> <i class="fa fa-trash"></i> Excluir</a></td></tr>');});$('.excluirEmailBase').on('click',function(){var id=$(this).data("codigo");var entidade=$("#entidade").val();$.ajax({url:"../../email/excluir/"+id,type:'GET',dataType:"JSON",success:function(response){$("#tabelaEmail > tbody > tr").remove();loadEmails(entidade);$.each(emails,function(index,value){$('#tabelaEmail > tbody').append('<tr><td class="center">'+value.descricao+'</td><td>'+value.email+'</td><td class="center"><a class="excluirFone" style="cursor:pointer" data-id="'+index+'"><i class="fa fa-trash"></i> Excluir</a></td></tr>');});},error:function(response){}});});},error:function(response){}});}
function loadTelefones(entidade){$.ajax({url:"../../fones/entidade/"+entidade,type:'GET',dataType:"JSON",success:function(response){$.each(response,function(index,value){$('#tabelaFone > tbody').append('<tr><td class="center">'+value.tipo.dc_tipo_fone_tfo+'</td><td>'+value.nu_fone_fon+'</td><td class="center"><a class="excluirFoneBase" style="cursor:pointer"  data-codigo="'+value.cd_fone_fon+'"> <i class="fa fa-trash"></i> Excluir</a></td></tr>');});$('.excluirFoneBase').on('click',function(){var id=$(this).data("codigo");var entidade=$("#entidade").val();$.ajax({url:"../../fones/excluir/"+id,type:'GET',dataType:"JSON",success:function(response){$("#tabelaFone > tbody > tr").remove();loadTelefones(entidade);$.each(telefones,function(index,value){$('#tabelaFone > tbody').append('<tr><td class="center">'+value.descricao+'</td><td>'+value.numero+'</td><td class="center"><a class="excluirFone"  style="cursor:pointer" data-id="'+index+'"><i class="fa fa-trash"></i> Excluir</a></td></tr>');});},error:function(response){}});});},error:function(response){}});}
function loadRegistrosBancarios(entidade){$.ajax({url:"../../registro-bancario/entidade/"+entidade,type:'GET',dataType:"JSON",success:function(response){$.each(response,function(index,value){value.nu_cpf_cnpj_dba=formatCnpjCpf(value.nu_cpf_cnpj_dba);$('#tabelaRegistroBancario > tbody').append("<tr><td data-nm_titular_dba='"+value.nm_titular_dba+"' >"+value.nm_titular_dba+"</td><td data-nu_cpf_cnpj_dba='"+value.nu_cpf_cnpj_dba+"' >"+value.nu_cpf_cnpj_dba+"</td><td data-cd_banco_ban='"+value.cd_banco_ban+"' >"+value.nm_banco_ban+"</td><td data-cd_tipo_conta_tcb='"+value.cd_tipo_conta_tcb+"' >"+value.nm_tipo_conta_tcb+"</td><td data-nu_agencia_dba='"+value.nu_agencia_dba+"' >"+value.nu_agencia_dba+"</td><td data-nu_conta_dba='"+value.nu_conta_dba+"' >"+value.nu_conta_dba+"</td><td class='center'><a class='editarDadosBancarios' style='cursor:pointer' data-codigo='"+value.cd_dados_bancarios_dba+"'><i class='fa fa-edit'></i> Editar</a>&nbsp;<a class='excluirDadosBancariosBase' style='cursor:pointer' data-codigo='"+value.cd_dados_bancarios_dba+"'><i class='fa fa-trash'></i> Excluir</a></td></tr>");});},error:function(response){}});}
function formatCnpjCpf(value){const cnpjCpf=value.replace(/\D/g,'');if(cnpjCpf.length===11){return cnpjCpf.replace(/(\d{3})(\d{3})(\d{3})(\d{2})/g,"\$1.\$2.\$3-\$4");}
return cnpjCpf.replace(/(\d{2})(\d{3})(\d{3})(\d{4})(\d{2})/g,"\$1.\$2.\$3/\$4-\$5");}
$('.excluirEmailBase').on('click',function(){var id=$(this).data("codigo");var entidade=$("#entidade").val();$.ajax({url:"../../email/excluir/"+id,type:'GET',dataType:"JSON",success:function(response){$("#tabelaEmail > tbody > tr").remove();loadEmails(entidade);$.each(emails,function(index,value){$('#tabelaEmail > tbody').append('<tr><td class="center">'+value.descricao+'</td><td>'+value.email+'</td><td class="center"><a class="excluirFone" style="cursor:pointer" data-id="'+index+'"><i class="fa fa-trash"></i> Excluir</a></td></tr>');});},error:function(response){}});});$(document).on('click','.excluirDadosBancariosBase',function(){var id=$(this).data("codigo");var entidade=$("#entidade").val();$.ajax({url:"../../registro-bancario/excluir/"+id,type:'GET',dataType:"JSON",success:function(response){$("#tabelaRegistroBancario > tbody > tr").remove();loadRegistrosBancarios(entidade);$.each(registrosBancarios,function(index,value){$('#tabelaRegistroBancario > tbody').append("<tr><td data-nm_titular_dba='"+value.titular+"' >"+value.titular+"</td><td data-nu_cpf_cnpj_dba='"+value.cpf+"' >"+value.cpf+"</td><td data-cd_banco_ban='"+value.banco+"' >"+value.bancoText+"</td><td data-cd_tipo_conta_tcb='"+value.tipo+"' >"+value.tipoText+"</td><td data-nu_agencia_dba='"+value.agencia+"' >"+value.agencia+"</td><td data-nu_conta_dba='"+value.conta+"' >"+value.conta+"</td><td class='center'><a class='editarDadosBancarios' style='cursor:pointer' data-id='"+index+"'><i class='fa fa-edit'></i> Editar</a>&nbsp;<a class='excluiRegistroBancario' style='cursor:pointer' data-id='"+index+"'><i class='fa fa-trash'></i> Excluir</a></td></tr>");});},error:function(response){}});});$('.excluirFoneBase').on('click',function(){var id=$(this).data("codigo");var entidade=$("#entidade").val();$.ajax({url:"../../fones/excluir/"+id,type:'GET',dataType:"JSON",success:function(response){$("#tabelaFone > tbody > tr").remove();loadTelefones(entidade);$.each(telefones,function(index,value){$('#tabelaFone > tbody').append('<tr><td class="center">'+value.descricao+'</td><td>'+value.numero+'</td><td class="center"><a class="excluirFone" style="cursor:pointer" data-id="'+index+'"><i class="fa fa-trash"></i> Excluir</a></td></tr>');});},error:function(response){}});});$('#modalFone').on('show.bs.modal',function(e){$("#nu_fone_fon").val("");$("#erroFone").html("");$("#nu_fone_fon").focus();});$('.btn_sigla').click(function(){$("#processamento").modal('show');});$("#btnSalvarHonorariosProcesso").click(function(){var processo=$("#cd_processo_pro").val();var servico=$("#tipoServico").val();var valor_cliente=$("#taxa-honorario-cliente").val();var valor_correspondente=$("#taxa-honorario-correspondente").val();var dados={servico:servico,valor_cliente:valor_cliente,valor_correspondente:valor_correspondente};$.ajax({type:"POST",url:pathname+"/processo/honorarios/salvar",data:{"_token":$('meta[name="token"]').attr('content'),"dados":JSON.stringify(dados),"processo":processo},beforeSend:function(){$("#processamento").modal('show');},success:function(response){window.location.href=pathname+"/processos/despesas/"+processo},error:function(response){location.reload();}});});$("#limparValoresDespesa").click(function(){$('.taxa-despesa').each(function(i,obj){$(this).val('');});})
$("#btnSalvarDespesasProcesso").click(function(){var valores=new Array();var processo=$("#cd_processo_pro").val();$('.taxa-despesa').each(function(i,obj){var valor=$(this).val();var despesa=$(this).data("despesa");var entidade=$(this).data("entidade");var oldvalue=$(this).data("oldvalue");var reembolso='N';if($('#'+$(this).data("identificador")).prop("checked")==true)
reembolso='S';if(oldvalue!=''||valor.trim()!=''){var dados={despesa:despesa,entidade:entidade,valor:valor,reembolso:reembolso};valores.push(dados);}});$.ajax({type:"POST",url:pathname+"/despesas/salvar",data:{"_token":$('meta[name="token"]').attr('content'),"valores":JSON.stringify(valores),"processo":processo},beforeSend:function(){$("#processamento").modal('show');},success:function(response){window.location.href=pathname+"/despesas/"+processo},error:function(response){location.reload();}});});$("#btnSalvarHonorarios").click(function(){var valores=new Array();var entidade=$("#cd_entidade").val();var cliente=$("#cd_cliente").val();$('.valor_honorario').each(function(i,obj){var valor=$.trim($(this).text().replace(/[\t\n]+/g,' '));var servico=$(this).data("servico");var cidade=$(this).data("cidade");var flag=$(this).attr("data-edit");if(valor!='Adicionar'&&flag=='S'){var dados={servico:servico,cidade:cidade,valor:valor};valores.push(dados);}});$.ajax({type:"POST",url:"../../cliente/honorarios/salvar",data:{"_token":$('meta[name="token"]').attr('content'),"valores":JSON.stringify(valores),"entidade":entidade},beforeSend:function(){$("#processamento").modal('show');},success:function(response){window.location.href="../../cliente/honorarios/"+cliente;},error:function(response){}});});$("#btnSalvarHonorariosCorrespondente").click(function(){var valores=new Array();var entidade=$("#cd_entidade").val();var correspondente=$("#cd_correspondente").val();$('.valor_honorario').each(function(i,obj){var valor=$.trim($(this).text().replace(/[\t\n]+/g,' '));var servico=$(this).data("servico");var cidade=$(this).data("cidade");var flag=$(this).attr("data-edit");if(valor!='Adicionar'&&flag=='S'){var dados={servico:servico,cidade:cidade,valor:valor};valores.push(dados);}});$.ajax({type:"POST",url:"../../correspondente/honorarios/salvar",data:{"_token":$('meta[name="token"]').attr('content'),"valores":JSON.stringify(valores),"entidade":entidade},beforeSend:function(){$("#processamento").modal('show');},success:function(response){$("#processamento").modal('hide');},error:function(response){$("#modal_erro").modal('show');}});});$("#grupo_cidade").change(function(){var grupo=$("#grupo_cidade option:selected").val();$.ajax({url:"../../grupo/cidade/"+grupo,type:'GET',dataType:"JSON",beforeSend:function(){$('#cidade').empty();$('#cidade').append('<option selected value="">Carregando...</option>');$('#cidade').prop("disabled",true);},success:function(response){$('#cidade').empty();$('#cidade').append('<option selected value="">Selecione</option>');$('#cidade').append('<option selected value="0">Todas</option>');$.each(response,function(index,value){$('#cidade').append('<option value="'+value.cd_cidade_cde+'">'+value.cidade.nm_cidade_cde+'</option>');});$('#cidade').trigger('change');$('#cidade').prop("disabled",false);},error:function(response){}});});$(".toda-cidade").click(function(){var obj_cidade=$(this).data("cidade");var obj_servico=$(this).data("servico");var obj_valor=$(this).closest("td").find(".taxa-honorario").val().replace(".",",");$(".taxa-honorario").each(function(){var servico=$(this).data("servico");if(obj_servico===servico){$(this).val(obj_valor);}});});$(".todo-servico").click(function(){var obj_cidade=$(this).data("cidade");var obj_servico=$(this).data("servico");var obj_valor=$(this).closest("td").find(".taxa-honorario").val().replace(".",",");$(".taxa-honorario").each(function(){var cidade=$(this).data("cidade");if(obj_cidade===cidade){$(this).val(obj_valor);}});});$(".toda-tabela").click(function(){var obj_valor=$(this).closest("td").find(".taxa-honorario").val().replace(".",",");$(".taxa-honorario").each(function(){$(this).val(obj_valor);});});$('.dialog_clone').click(function(){$('#dialog_clone_text').data('url',$(this).attr('href')).dialog('open');return false;});$('#dialog_clone_text').dialog({autoOpen:false,width:600,resizable:false,modal:true,title:'Deseja clonar esse processo?',buttons:[{html:"<i class='fa fa-clone fa-la'></i>&nbsp; Continuar","class":"btn sa-btn-danger",click:function(){window.location=$(this).data('url');}},{html:"<i class='fa fa-times'></i>&nbsp; Cancelar","class":"btn btn-default",click:function(){$(this).dialog("close");}}]});$("input[data-vreembolso='N']").click(function(){if($(this).is(':checked')){$("input[data-identificador='"+$(this).attr('name')+"']").prop("disabled",false);}else{$("input[data-identificador='"+$(this).attr('name')+"']").prop("disabled",true);$("input[data-identificador='"+$(this).attr('name')+"']").val('');}})
$("input[data-vreembolso='N']").each(function(){if(!$(this).is(':checked')){$("input[data-identificador='"+$(this).attr('name')+"']").prop("disabled",true);$("input[data-identificador='"+$(this).attr('name')+"']").val('');}});});